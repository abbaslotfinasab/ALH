{% extends "base.html" %}
{% block content %}


<section id="handwriting" class="py-5 feed-section">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="fw-bold section-title">دست‌خط من</h2>
      <p class="section-subtitle">تکه‌کدهایی از مسیر یادگیری، پروژه‌ها و چالش‌های واقعی</p>
    </div>

    <div class="row g-4">
      <!-- کارت نمونه -->
      <div class="col-12 col-md-6 col-lg-4">
        <div class="car vision-card p-4 rounded-4 h-100 position-relative">
          <h5 class="fw-bold mb-2">بهینه‌سازی QuerySet در Django</h5>
          <p class="small text-muted mb-3">چطور با prefetch_related تعداد Queryها رو نصف کردم.</p>
          <pre><code class="language-python">users = User.objects.prefetch_related("posts", "comments")</code></pre>
          <button class="btn more-link mt-3" data-bs-toggle="modal" data-bs-target="#codeModal1">
            بیشتر
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="codeModal1" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content bg-dark text-white border-0 rounded-4">
        <div class="modal-header border-secondary">
          <h5 class="modal-title">بهینه‌سازی QuerySet در Django</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <pre><code class="language-python"># قبل
for user in User.objects.all():
    print(user.posts.count())

# بعد
users = User.objects.prefetch_related("posts")
for user in users:
    print(user.posts.count())</code></pre>
          <p class="mt-3 small opacity-75">
            نتیجه: Queryها از ۱۲۵ تا به ۳ تا کاهش پیدا کرد.
            زمان پاسخ API حدود ۴ برابر سریع‌تر شد 🚀
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

{% endblock %}
